{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "required": [
    "creationDateTime",
    "senderBusinessId"
  ],
  "definitions": {
    "account": {
      "type": "object",
      "description": "Tili",
      "required": [
        "id",
        "openingDate",
        "roles"
      ],
      "properties": {
        "id": { "$ref": "#/definitions/accountIdentification" },
        "openingDate": {
          "description": "Tilin avauspäivämäärä.",
          "$ref": "#/definitions/date"
        },
        "closingDate": {
          "description": "Tilin sulkemispäivämäärä.",
          "$ref": "#/definitions/date"
        },
        "roles": {
          "type": "array",
          "description": "Tiliin liittyvät roolit.",
          "items": { "$ref": "#/definitions/role" }
        }
      }
    },
    "accountIdentification": {
      "type": "object",
      "description": "Tilin tunnistetieto.",
      "oneOf": [
        {
          "required": [
            "iban"
          ]
        },
        {
          "required": [
            "other"
          ]
        }
      ],
      "properties": {
        "iban": {
          "type": "string",
          "description": "IBAN tilinumero.",
          "examples": [
            "FI2753564444694907"
          ]
        },
        "other": { "$ref": "#/definitions/otherAccountIdentification" }
      }
    },
    "businessId": {
      "type": "string",
      "description": "Y-tunnus",
      "examples": [
        "0245442-8"
      ],
      "minLength": 9,
      "maxLength": 9,
      "pattern": "[0-9]{7}[-][0-9]"
    },
    "customer": {
      "type": "object",
      "description": "Asiakkuus",
      "required": [
        "startDate"
      ],
      "properties": {
        "startDate": {
          "description": "Asiakkuuden alkamispäivämäärä.",
          "$ref": "#/definitions/date"
        },
        "endDate": {
          "description": "Asiakkuuden päättymispäivämäärä.",
          "$ref": "#/definitions/date"
        }
      }
    },
    "date": {
      "type": "string",
      "examples": [
        "2019-08-17"
      ]
    },
    "legalPerson": {
      "type": "object",
      "description": "Oikeussubjekti joka on aina oikeushenkilö tai luonnollinen henkilö.",
      "properties": {
        "organisation": { "$ref": "#/definitions/organisation" },
        "privatePerson": { "$ref": "#/definitions/privatePerson" }
      },
      "oneOf": [
        {
          "required": [
            "organisation"
          ]
        },
        {
          "required": [
            "privatePerson"
          ]
        }
      ]
    },
    "organisation": {
      "type": "object",
      "description": "Oikeushenkilö",
      "oneOf": [
        {
          "required": [
            "businessId",
            "businessIdCountryCode",
            "roles"
          ]
        },
        {
          "required": [
            "otherOrganisationId",
            "roles"
          ]
        }
      ],
      "properties": {
        "businessId": { "$ref": "#/definitions/businessId" },
        "businessIdCountryCode": {
          "type": "string",
          "description": "Jos businessId on suomalainen Y-tunnus, businessIdCountryCode arvoksi asetetaan “FI”. Jos Y-tunnusta tai vastaavaa ei ole saatavilla, annetaan otherOrganisationId.",
          "examples": [
            "FI"
          ],
          "minLength": 2,
          "maxLength": 2
        },
        "registrationAuthority": {
          "type": "string",
          "description": "Rekisteriviranomainen"
        },
        "registrationDate": {
          "description": "Rekisteröitymispäivä",
          "$ref": "#/definitions/date"
        },
        "roles": {
          "type": "array",
          "description": "Edunsaajat. Roolin tyyppinä aina beneficiary.",
          "items": { "$ref": "#/definitions/role" }
        },
        "name": {
          "type": "string",
          "description": "Organisaation nimi."
        },
        "otherOrganisationId": { "$ref": "#/definitions/otherOrganisationId" }
      }
    },
    "otherAccountIdentification": {
      "type": "object",
      "description": "Muu kuin IBAN tilinumero.",
      "required": [
        "id",
        "description"
      ],
      "properties": {
        "id": {
          "type": "string",
          "description": "Tilin tunniste."
        },
        "description": {
          "type": "string",
          "description": "Kuvaus käytetystä tilitunnisteesta."
        }
      }
    },
    "otherOrganisationId": {
      "type": "object",
      "description": "Muu organisaation tunniste (käytetään jos y-tunnusta ei ole).",
      "required": [
        "id",
        "description"
      ],
      "properties": {
        "id": {
          "type": "string",
          "title": "Id",
          "description": "Organisaatioon liittyvä tunniste (muu kuin y-tunnus)."
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Kuvaus käytetystä tunnisteesta."
        }
      }
    },
    "privatePerson": {
      "type": "object",
      "description": "Luonnollinen henkilö.",
      "oneOf": [
        {
          "required": [
            "lastName",
            "firstNames",
            "birthdate",
            "nationality",
            "hetu"
          ]
        },
        {
          "required": [
            "lastName",
            "firstNames",
            "birthdate",
            "nationality",
            "identificationDocumentId"
          ]
        }
      ],
      "properties": {
        "lastName": {
          "type": "string",
          "description": "Sukunimi",
          "examples": [
            "Korhonen"
          ]
        },
        "firstNames": {
          "type": "string",
          "description": "Etunimet välilyönneillä eroteltuina.",
          "examples": [
            "Juhani Antti"
          ]
        },
        "birthdate": {
          "description": "Syntymäaika",
          "$ref": "#/definitions/date"
        },
        "nationality": {
          "type": "string",
          "description": "Kansallisuus",
          "examples": [
            "FI"
          ],
          "minLength": 2,
          "maxLength": 2
        },
        "hetu": {
          "type": "string",
          "description": "Henkilöturvatunnus",
          "examples": [
            "151080-999L"
          ]
        },
        "identificationDocumentId": {
          "type": "string",
          "description": "Henkilöllisyystodistuksen tunniste (käytetään jos henkilöturvatunnusta ei ole)."
        }
      }
    },
    "role": {
      "type": "object",
      "description": "Rooli",
      "required": [
        "startDate",
        "type",
        "legalPersonId"
      ],
      "properties": {
        "startDate": {
          "description": "Roolin alkamispäivämäärä.",
          "$ref": "#/definitions/date"
        },
        "endDate": {
          "description": "Roolin päättymispäivämäärä.",
          "$ref": "#/definitions/date"
        },
        "type": {
          "type": "string",
          "description": "Roolin tyyppi.",
          "enum": ["owner", "access", "beneficiary"]
        },
        "legalPersonId": {
          "description": "Oikeussubjektin tunniste",
          "$ref": "#/definitions/uuidv4"
        }
      }
    },
    "safetyDepositBox": {
      "type": "object",
      "description": "Tallelokero",
      "required": [
        "id",
        "startDate",
        "roles"
      ],
      "properties": {
        "id": {
          "type": "string",
          "description": "Tallelokeron tunniste.",
          "examples": [
            "OKOYFIHH-41138848"
          ]
        },
        "startDate": {
          "description": "Tallelokeron alkamispäivämäärä.",
          "$ref": "#/definitions/date"
        },
        "endDate": {
          "description": "Tallelokeron päättymispäivämäärä.",
          "$ref": "#/definitions/date"
        },
        "roles": {
          "type": "array",
          "description": "Tallelokeroon liittyvät roolit.",
          "items": { "$ref": "#/definitions/role" }
        }
      }
    },
    "uuidv4": {
      "type": "string",
      "description": "Yksiselitteinen tunniste tietueelle. UUIDv4.",
      "examples": [
        "91e8c532-71e1-4c4f-bf30-ceec6160ece0"
      ]
    }
  },
  "properties": {
    "creationDateTime": {
      "$id": "#/properties/creationDateTime",
      "description": "Päivityssanoman päivämäärä.",
      "$ref": "#/definitions/date"
    },
    "senderBusinessId": {
      "$id": "#/properties/senderBusinessId",
      "description": "Lähettäjän y-tunnus.",
      "$ref": "#/definitions/businessId"
    },
    "legalPersons": {
      "$id": "#/properties/legalPersons",
      "type": "object",
      "additionalProperties": {
        "$ref": "#/definitions/legalPerson"
      },
      "description": "Oikeussubjektit"
    },
    "customers": {
      "$id": "#/properties/customers",
      "type": "object",
      "additionalProperties": {
        "$ref": "#/definitions/customer"
      },
      "description": "Asiakkuudet"
    },
    "accounts": {
      "$id": "#/properties/accounts",
      "type": "object",
      "additionalProperties": {
        "$ref": "#/definitions/account"
      },
      "description": "Tilit"
    },
    "safetyDepositBoxes": {
      "$id": "#/properties/safetyDepositBoxes",
      "type": "object",
      "additionalProperties": {
        "$ref": "#/definitions/safetyDepositBox"
      },
      "description": "Tallelokerot"
    }
  }
}